<div class="row">
  <div class="col-xs-12 col-lg-10">
    <div class="card card--job">
      <h2 class="card-header">Job #<%= @job&.id %>
        - Import
        <%= status_span_generator(@job&.status) %>
      </h2>

      <div class="card-body">
        <div class="row">
          <div class="col-md-8">
            <div class="row">
              <dl class="col-md-4">
                <dt>User</dt>
                <dd class="jobs-user"><%= @job&.user %></dd>
              </dl>
              <dl class="col-md-4">
                <dt>Submitted At</dt>
                <dd class="jobs-created_at"><%= @job&.created_at %></dd>
              </dl>
              <dl class="col-md-4">
                <dt>Completed at</dt>
                <dd class="jobs-completed_at"><%= @job&.completed_at || raw("&ndash;") %><dd>
              </dl>
            </div>
            <div class="row">
              <dl class="col-md-12 filename">
                <dt>File</dt>
                <dd class="job-manifest">
                  <% if @job&.parent_job&.manifest&.attached? %>
                    <%= link_to(@job&.parent_job.manifest.filename, rails_blob_path(@job&.parent_job.manifest, disposition: 'attachment'), class: "card-link") %>
                    <span class="fa fa-download"></span>
                  <% else %>
                    &ndash;
                  <% end %>
                </dd>
              </dl>
            </div>
          </div>
          <div class="col-md-4 card-text">
            <div class="row">
              <dl class="col-xs-4">
                <dt>Collections</dt>
                <dd class="job-number jobs-collections">
                  <%= @job&.collections || raw("&ndash;") %>
                </dd>
              </dl>
              <dl class="col-xs-4">
                <dt>Works</dt>
                <dd class="job-number jobs-works"><%= @job&.works || raw("&ndash;") %></dd>
              </dl>
              <dl class="col-xs-4">
                <dt>Files</dt>
                <dd class="job-number jobs-files"><%= @job&.files || raw("&ndash;") %></dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card card--job">
      <div class="card-body">
        <table class="table table-responsive table--job">
          <thead>
            <th class="title">title /
              <em>filename</em>
            </th>
            <th class="item_status">Status</th>
            <th class="identifier">Identifier</th>
            <th class="lineno">Row</th>
            <th class="index">Order</th>
            <th class="type">Type</th>
            <th class="visibility">Visibility</th>
            <th class="collection_count">cs</th>
            <th class="work_count">ws</th>
            <th class="file_count">fs</th>
          </thead>
          <tbody></tbody>
        </table>
        <% @root.dig('children')&.each do |child| %>
          <%= render "child", node: child, parent: "0", depth: 0, order: nil %>
        <% end %>
      </div>
    </div>
  </div>
</div>
